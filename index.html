<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†Ø´Ø¦ Ø§Ù„Ø­Ù‚Ø§Ø¦Ø¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ - Ø£ÙŠØ§Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #16a085;
            --accent: #d35400;
            --bg: #eef2f3;
            --cover-bg: #ffffff;
            --sidebar-width: 550px;
        }

        * { box-sizing: border-box; }

        body { 
            font-family: 'Cairo', sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding: 0; 
        }

        .app-container {
            display: flex;
            flex-direction: row;
            min-height: 100vh;
        }

        /* --- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© --- */
        .editor-sidebar {
            width: var(--sidebar-width);
            background: white;
            padding: 25px;
            border-left: 2px solid #ddd;
            overflow-y: auto;
            height: 100vh;
            position: fixed;
            right: 0;
            top: 0;
            z-index: 100;
            box-shadow: -2px 0 15px rgba(0,0,0,0.1);
        }

        /* --- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© --- */
        .preview-area {
            margin-right: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
            background: #525659;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Ø§Ù„ÙˆØ±Ù‚Ø© --- */
        .sheet {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin-bottom: 30px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            position: relative;
            display: flex;
            flex-direction: column;
            page-break-after: always;
        }

        /* --- Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª --- */
        .cover-page { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 5px double var(--primary); background-color: var(--cover-bg); text-align: center; }
        .page-title { border-bottom: 3px solid var(--primary); padding-bottom: 10px; margin-bottom: 30px; text-align: center; color: var(--primary); font-size: 24px; }
        
        .justified-text { text-align: justify; line-height: 1.8; font-size: 16px; }
        
        .styled-list { list-style: none; padding: 0; }
        .styled-list li { margin-bottom: 10px; padding-right: 25px; position: relative; line-height: 1.6; }
        .styled-list li::before { content: 'âœ”'; position: absolute; right: 0; color: var(--secondary); }

        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; }
        th, td { border: 1px solid #444; padding: 8px; text-align: center; font-size: 12px; }
        th { background: #eee; }

        .tools-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; text-align: center; }
        .tool-item { border: 1px solid #ccc; padding: 20px; border-radius: 10px; }

        .center-page-content { display: flex; justify-content: center; align-items: center; flex: 1; height: 100%; text-align: center; }

        /* --- Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± --- */
        label { display: block; margin-top: 15px; font-weight: bold; color: var(--primary); }
        input, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; background: #f9f9f9; display: block; margin-bottom: 5px; font-family: 'Cairo'; }
        
        details { background: #fff; border: 1px solid #ddd; margin-bottom: 15px; border-radius: 5px; }
        summary { padding: 12px; background: #f1f2f6; cursor: pointer; font-weight: bold; }
        .details-body { padding: 15px; }

        .btn-row { display: flex; gap: 10px; margin-top: 20px; position: sticky; bottom: 0; background: white; padding: 10px 0; border-top: 1px solid #eee; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; font-family: 'Cairo'; font-size: 14px; }
        .btn-pdf { background: var(--primary); }
        .btn-word { background: #2980b9; }

        .color-row { display: flex; gap: 10px; justify-content: center; margin: 10px 0; }
        .color-circle { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #ddd; cursor: pointer; }
        .color-circle.active { border-color: #333; transform: scale(1.1); }

        @media print {
            body { background: white; }
            .editor-sidebar { display: none !important; }
            .preview-area { margin: 0; padding: 0; width: 100%; background: white; display: block; }
            .sheet { 
                box-shadow: none; margin: 0; border: none; width: 100%; 
                page-break-after: always; page-break-inside: avoid;
                min-height: auto; 
            }
            .app-container { display: block; }
            .btn-row, button { display: none; }
        }

        @media (max-width: 1000px) {
            .app-container { flex-direction: column; }
            .editor-sidebar { width: 100%; height: auto; position: relative; }
            .preview-area { width: 100%; margin: 0; padding: 10px; }
            .sheet { transform: scale(0.95); margin-bottom: 10px; }
        }
    </style>
</head>
<body>

<div class="app-container">
    
    <div class="editor-sidebar">
        <h3 style="text-align:center;">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</h3>
        
        <div style="text-align:center; font-size:12px; color:#777; margin-bottom:15px; border:1px dashed #ccc; padding:5px;">
            Ø­Ù‚ÙˆÙ‚ Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø© Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ù…Ø¯Ø±Ø¨ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø¹Ø³ÙŠØ±ÙŠ <br> <b>@MOHDASIRI99</b>
        </div>

        <div style="background:#f4f4f4; padding:10px; border-radius:10px; text-align:center;">
            <label style="margin-top:0">Ù„ÙˆÙ† Ø§Ù„ØºÙ„Ø§Ù</label>
            <div class="color-row">
                <div class="color-circle" style="background:#fff;" onclick="setCover('#fff', this)"></div>
                <div class="color-circle" style="background:#fff9c4;" onclick="setCover('#fff9c4', this)"></div>
                <div class="color-circle" style="background:#e8f5e9;" onclick="setCover('#e8f5e9', this)"></div>
                <div class="color-circle" style="background:#ffebee;" onclick="setCover('#ffebee', this)"></div>
                <div class="color-circle" style="background:#e3f2fd;" onclick="setCover('#e3f2fd', this)"></div>
            </div>
        </div>

        <br>

        <details open><summary>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</summary>
            <div class="details-body">
                <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input type="text" id="inTitle" oninput="render()">
                <label>Ø§Ù„Ù…Ø¯Ø±Ø¨</label><input type="text" id="inTrainer" oninput="render()">
                <label>Ø§Ù„Ø¹Ø§Ù…</label><input type="text" id="inYear" value="2026" oninput="render()">
                <hr>
                <div style="display:flex; gap:5px; align-items:flex-end;">
                    <div style="flex:1">
                        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… (Ø§Ù„Ø¬Ø¯ÙˆÙ„)</label>
                        <input type="number" id="inDays" value="3" min="1" max="15" onchange="updateDays()" oninput="render()">
                    </div>
                    <div style="flex:1">
                        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</label>
                        <input type="text" id="inHours" oninput="render()">
                    </div>
                </div>
                <label>Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙˆÙ†</label><input id="inAudience" oninput="render()">
            </div>
        </details>

        <details><summary>Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© ÙˆØ§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</summary>
            <div class="details-body">
                <label>Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</label><textarea id="inIntro" oninput="render()"></textarea>
                <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø¨</label><textarea id="inTrainerGuide" oninput="render()"></textarea>
                <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¯Ø±Ø¨</label><textarea id="inTraineeGuide" oninput="render()"></textarea>
            </div>
        </details>

        <details><summary>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</summary>
            <div class="details-body">
                <label>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹Ø§Ù…</label><textarea id="inMainGoal" oninput="render()"></textarea>
                <label>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</label><textarea id="inSubGoals" oninput="render()"></textarea>
            </div>
        </details>

        <details><summary>Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ (Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ)</summary>
            <div class="details-body" id="schedule-inputs">
                </div>
        </details>

        <details><summary>Ø§Ù„Ù…Ø¹ÙŠÙ†Ø§Øª</summary>
            <div class="details-body">
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
                    <label><input type="checkbox" id="t1" checked onchange="render()"> Ø³Ø¨ÙˆØ±Ø© ÙˆØ±Ù‚ÙŠØ©</label>
                    <label><input type="checkbox" id="t2" checked onchange="render()"> Ø³Ø¨ÙˆØ±Ø© Ø°ÙƒÙŠØ©</label>
                    <label><input type="checkbox" id="t3" checked onchange="render()"> Ø£Ù‚Ù„Ø§Ù…</label>
                    <label><input type="checkbox" id="t4" checked onchange="render()"> Ù…Ù„ØµÙ‚Ø§Øª</label>
                    <label><input type="checkbox" id="t5" checked onchange="render()"> Ù„Ø§Ø¨ØªÙˆØ¨</label>
                    <label><input type="checkbox" id="t6" checked onchange="render()"> Ø¯Ø§ØªØ§Ø´Ùˆ</label>
                    <label><input type="checkbox" id="t7" onchange="render()"> ØµÙˆØªÙŠØ§Øª</label>
                </div>
                <label>Ø£Ø®Ø±Ù‰</label><input id="tOther" oninput="render()">
            </div>
        </details>

        <div id="units-container"></div>
        <button style="width:100%; padding:10px; background:#16a085; color:white; border:none; margin-top:10px; cursor:pointer" onclick="addUnit()">+ Ø¥Ø¶Ø§ÙØ© ÙˆØ­Ø¯Ø©</button>

        <details style="margin-top:10px"><summary>Ø§Ù„Ø®Ø§ØªÙ…Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹</summary>
            <div class="details-body">
                <label>Ø§Ù„Ø®Ø§ØªÙ…Ø©</label><textarea id="inConc" oninput="render()"></textarea>
                <label>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</label><textarea id="inRef" oninput="render()"></textarea>
            </div>
        </details>

        <div class="btn-row">
            <button class="btn btn-pdf" onclick="window.print()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸ PDF</button>
            <button class="btn btn-word" onclick="exportToWord()">ğŸ“„ ØªØµØ¯ÙŠØ± Word</button>
        </div>
    </div>

    <div class="preview-area" id="word-content">
        
        <div class="sheet">
            <div class="cover-page" id="coverPage">
                <h1 id="outTitle" style="font-size:40px; color:#2c3e50;">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</h1>
                <h3 style="margin-top:50px;">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¯Ø±Ø¨:</h3>
                <h2 id="outTrainer" style="color:#16a085;">---</h2>
                <p style="margin-top:20px;">Ø§Ù„Ø¹Ø§Ù… Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ: <span id="outYear">2026</span></p>
            </div>
        </div>

        <div class="sheet">
            <h2 class="page-title">Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
            <div id="outIntro" class="justified-text">...</div>
        </div>

        <div class="sheet">
            <h2 class="page-title">Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù„Ù„Ù…Ø¯Ø±Ø¨</h2>
            <ul class="styled-list" id="outTrainerGuide"></ul>
        </div>

        <div class="sheet">
            <h2 class="page-title">Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù„Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</h2>
            <ul class="styled-list" id="outTraineeGuide"></ul>
        </div>

        <div class="sheet">
            <h2 class="page-title">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
            <div style="background:#f9f9f9; padding:20px; border-right:5px solid #2c3e50; margin-bottom:20px;">
                <h3>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹Ø§Ù…:</h3>
                <p id="outMainGoal">...</p>
            </div>
            <h3>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©:</h3>
            <ul class="styled-list" id="outSubGoals"></ul>
        </div>

        <div class="sheet">
            <h2 class="page-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2>
            <div style="padding:20px; border:1px solid #ddd; font-size:18px; line-height:2;">
                <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…:</b> <span id="outDays">...</span></p>
                <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª:</b> <span id="outHours">...</span></p>
                <p><b>Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙˆÙ†:</b> <span id="outAudience">...</span></p>
            </div>
        </div>

        <div class="sheet">
            <div class="center-page-content">
                <div style="border:5px solid #2c3e50; padding:40px; border-radius:20px;">
                    <h1>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h1>
                </div>
            </div>
        </div>

        <div id="outSchedule"></div>

        <div class="sheet">
            <h2 class="page-title">Ø§Ù„Ù…Ø¹ÙŠÙ†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h2>
            <div class="tools-grid" id="outTools"></div>
        </div>

        <div id="outUnits"></div>

        <div class="sheet">
            <h2 class="page-title">Ø§Ù„Ø®Ø§ØªÙ…Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹</h2>
            <h3>Ø§Ù„Ø®Ø§ØªÙ…Ø©:</h3>
            <div id="outConc" class="justified-text">...</div>
            <hr>
            <h3>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹:</h3>
            <div id="outRef" class="justified-text">...</div>
        </div>

        <div class="sheet">
            <div class="center-page-content">
                <h1>ØªÙ… Ø¨Ø­Ù…Ø¯ Ø§Ù„Ù„Ù‡</h1>
            </div>
        </div>

    </div>
</div>

<script>
    // Ù…ØªØºÙŠØ± Ù„ØªØ®Ø²ÙŠÙ† Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
    let currentDayCount = 3;

    window.onload = function() {
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        updateDays();
        addUnit();
        render();
    };

    function setCover(color, el) {
        document.documentElement.style.setProperty('--cover-bg', color);
        document.querySelectorAll('.color-circle').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
    }

    // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…
    function updateDays() {
        const input = document.getElementById('inDays');
        let newCount = parseInt(input.value);
        if(newCount < 1) newCount = 1;
        if(newCount > 30) newCount = 30; // Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ù„Ù„Ø­Ù…Ø§ÙŠØ©

        // 1. Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ Ø­ØªÙ‰ Ù„Ø§ ØªØ¶ÙŠØ¹ Ø¹Ù†Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡
        const savedData = {};
        const inputs = document.querySelectorAll('#schedule-inputs input');
        inputs.forEach(inp => {
            savedData[inp.className] = inp.value;
        });

        currentDayCount = newCount;
        
        // 2. Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
        buildScheduleInputs(currentDayCount);

        // 3. Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù„Ø®Ø§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ²Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯Ø©
        const newInputs = document.querySelectorAll('#schedule-inputs input');
        newInputs.forEach(inp => {
            if(savedData[inp.className]) {
                inp.value = savedData[inp.className];
            }
        });

        // 4. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
        render();
    }

    // Ø¯Ø§Ù„Ø© Ø¨Ù†Ø§Ø¡ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ (Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©)
    function buildScheduleInputs(days) {
        const container = document.getElementById('schedule-inputs');
        container.innerHTML = ''; // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ…

        for(let d=1; d<=days; d++) {
            let html = `<div style="background:#f4f4f4; padding:10px; margin-bottom:10px;">
                <b>Ø§Ù„ÙŠÙˆÙ… ${d}</b>`;
            for(let s=1; s<=2; s++) {
                html += `<div style="margin-top:5px; font-size:12px;">Ø§Ù„Ø¬Ù„Ø³Ø© ${s}</div>`;
                for(let r=1; r<=4; r++) {
                    let id = `d${d}s${s}r${r}`;
                    html += `<div style="display:flex; gap:2px;">
                        <input class="${id}_t" placeholder="Ù…ÙˆØ¶ÙˆØ¹" oninput="render()" style="flex:2">
                        <input class="${id}_m" placeholder="Ø£Ø³Ù„ÙˆØ¨" oninput="render()" style="flex:1">
                        <input class="${id}_l" placeholder="Ø£Ø¯Ø§Ø©" oninput="render()" style="flex:1">
                        <input class="${id}_z" placeholder="Ø¯" oninput="render()" style="flex:0.5">
                    </div>`;
                }
            }
            html += `</div>`;
            container.innerHTML += html;
        }
    }

    let uCount = 0;
    function addUnit() {
        uCount++;
        const div = document.createElement('div');
        div.style.marginBottom = "10px";
        div.innerHTML = `
            <div style="background:#34495e; color:white; padding:5px; display:flex; justify-content:space-between;">
                <span>ÙˆØ­Ø¯Ø© ${uCount}</span>
                <span onclick="this.parentElement.parentElement.remove(); render()" style="cursor:pointer; color:red">x</span>
            </div>
            <div style="padding:10px; border:1px solid #ccc;">
                <input class="u-title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" oninput="render()">
                <textarea class="u-cont" placeholder="Ø§Ù„Ù…Ø­ØªÙˆÙ‰" oninput="render()"></textarea>
                <textarea class="u-act" placeholder="Ø§Ù„Ù†Ø´Ø§Ø·" oninput="render()"></textarea>
                <textarea class="u-eval" placeholder="Ø§Ù„ØªÙ‚ÙŠÙŠÙ…" oninput="render()"></textarea>
            </div>
        `;
        document.getElementById('units-container').appendChild(div);
        render();
    }

    function render() {
        // Ù†ØµÙˆØµ
        setId('outTitle', 'inTitle', 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©');
        setId('outTrainer', 'inTrainer', '---');
        setId('outYear', 'inYear', '---');
        setId('outDays', 'inDays', '---');
        setId('outHours', 'inHours', '---');
        setId('outAudience', 'inAudience', '---');
        
        setHtml('outIntro', 'inIntro');
        setHtml('outMainGoal', 'inMainGoal');
        setHtml('outConc', 'inConc');
        setHtml('outRef', 'inRef');
        
        setList('outTrainerGuide', 'inTrainerGuide');
        setList('outTraineeGuide', 'inTraineeGuide');
        setList('outSubGoals', 'inSubGoals');

        // Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ (ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ currentDayCount)
        let schHtml = '';
        for(let d=1; d<=currentDayCount; d++) {
            schHtml += `<div class="sheet"><h2 class="page-title">Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ: ${d}</h2>
            <table><thead><tr><th width="35%">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th><th>Ø§Ù„Ø£Ø³Ù„ÙˆØ¨</th><th>Ø§Ù„Ø£Ø¯Ø§Ø©</th><th width="10%">Ø²Ù…Ù†</th></tr></thead><tbody>`;
            for(let s=1; s<=2; s++) {
                schHtml += `<tr><td colspan="4" style="background:#e0f2f1; font-weight:bold;">Ø§Ù„Ø¬Ù„Ø³Ø© ${s}</td></tr>`;
                for(let r=1; r<=4; r++) {
                    let id = `d${d}s${s}r${r}`;
                    let t = document.querySelector(`.${id}_t`)?.value || '';
                    let m = document.querySelector(`.${id}_m`)?.value || '';
                    let l = document.querySelector(`.${id}_l`)?.value || '';
                    let z = document.querySelector(`.${id}_z`)?.value || '';
                    if(t||m||l||z) schHtml += `<tr><td>${t}</td><td>${m}</td><td>${l}</td><td>${z}</td></tr>`;
                }
                if(s==1) schHtml += `<tr><td colspan="4" style="background:#fff3e0">Ø§Ø³ØªØ±Ø§Ø­Ø©</td></tr>`;
            }
            schHtml += `</tbody></table></div>`;
        }
        document.getElementById('outSchedule').innerHTML = schHtml;

        // Ø§Ù„ÙˆØ­Ø¯Ø§Øª
        let uHtml = '';
        document.querySelectorAll('#units-container > div').forEach(div => {
            let t = div.querySelector('.u-title').value || 'ÙˆØ­Ø¯Ø©';
            let c = div.querySelector('.u-cont').value.replace(/\n/g, '<br>');
            let a = div.querySelector('.u-act').value.replace(/\n/g, '<br>');
            let e = div.querySelector('.u-eval').value.replace(/\n/g, '<br>');
            uHtml += `<div class="sheet"><h2 class="page-title">${t}</h2>
                <h4>Ø§Ù„Ù…Ø­ØªÙˆÙ‰:</h4><div class="justified-text">${c}</div>
                <div style="background:#f9f9f9; padding:15px; border:1px dashed #999; margin:10px 0;"><b>Ù†Ø´Ø§Ø·:</b><br><div class="justified-text">${a}</div></div>
                <div style="color:#d35400"><b>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</b><br><div class="justified-text">${e}</div></div>
            </div>`;
        });
        document.getElementById('outUnits').innerHTML = uHtml;

        // Ø§Ù„Ø£Ø¯ÙˆØ§Øª
        const icons = [
            {id:'t1', i:'fa-scroll', t:'Ø³Ø¨ÙˆØ±Ø© ÙˆØ±Ù‚ÙŠØ©'}, {id:'t2', i:'fa-chalkboard-user', t:'Ø³Ø¨ÙˆØ±Ø© Ø°ÙƒÙŠØ©'},
            {id:'t3', i:'fa-pen-nib', t:'Ø£Ù‚Ù„Ø§Ù…'}, {id:'t4', i:'fa-note-sticky', t:'Ù…Ù„ØµÙ‚Ø§Øª'},
            {id:'t5', i:'fa-laptop', t:'Ù„Ø§Ø¨ØªÙˆØ¨'}, {id:'t6', i:'fa-video', t:'Ø¯Ø§ØªØ§Ø´Ùˆ'}, {id:'t7', i:'fa-volume-high', t:'ØµÙˆØªÙŠØ§Øª'}
        ];
        let icHtml = '';
        icons.forEach(ic => {
            if(document.getElementById(ic.id).checked) icHtml += `<div class="tool-item"><i class="fas ${ic.i}" style="font-size:40px; color:#2c3e50"></i><br>${ic.t}</div>`;
        });
        let other = document.getElementById('tOther').value;
        if(other) icHtml += `<div class="tool-item"><i class="fas fa-plus" style="font-size:40px;"></i><br>${other}</div>`;
        document.getElementById('outTools').innerHTML = icHtml;
    }

    function setId(o, i, d) { document.getElementById(o).innerText = document.getElementById(i).value || d; }
    function setHtml(o, i) { document.getElementById(o).innerHTML = document.getElementById(i).value.replace(/\n/g, '<br>') || '...'; }
    function setList(o, i) { 
        let v = document.getElementById(i).value;
        document.getElementById(o).innerHTML = v ? v.split('\n').map(x=>`<li>${x}</li>`).join('') : '';
    }

    function exportToWord() {
        var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' "+
             "xmlns:w='urn:schemas-microsoft-com:office:word' "+
             "xmlns='http://www.w3.org/TR/REC-html40'>"+
             "<head><meta charset='utf-8'><title>Training Bag</title></head><body>";
        var footer = "</body></html>";
        var sourceHTML = header + document.getElementById("word-content").innerHTML + footer;
        var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
        var fileDownload = document.createElement("a");
        document.body.appendChild(fileDownload);
        fileDownload.href = source;
        fileDownload.download = 'training_bag.doc';
        fileDownload.click();
        document.body.removeChild(fileDownload);
    }
</script>

</body>
</html>

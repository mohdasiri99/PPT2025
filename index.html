<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµØ§Ù†Ø¹ Ø§Ù„Ø­Ù‚Ø§Ø¦Ø¨ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #1abc9c;
            --accent: #e74c3c;
            --bg: #f0f2f5;
            --text: #333;
        }

        * { box-sizing: border-box; }

        body { 
            font-family: 'Cairo', sans-serif; 
            background: var(--bg); 
            margin: 0; 
            padding: 0; 
            height: 100vh;
            display: flex;
            overflow: hidden;
        }
        
        /* --- Sidebar --- */
        .sidebar {
            width: 360px;
            background: white;
            padding: 20px;
            overflow-y: auto;
            border-left: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 10;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        h3 { margin: 0; font-size: 16px; color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 5px; }

        label { display: block; font-size: 12px; font-weight: bold; margin-bottom: 3px; color: #555; margin-top: 8px;}
        input, textarea { 
            width: 100%; 
            padding: 8px; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            font-family: 'Cairo'; 
            font-size: 12px;
        }
        textarea { height: 50px; resize: vertical; }

        .btn { width: 100%; padding: 10px; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; color: white; margin-top: 5px; font-family: 'Cairo'; }
        .btn-green { background: var(--secondary); }
        .btn-blue { background: var(--primary); font-size: 16px; margin-top: auto; position: sticky; bottom: 0; }
        .btn-red { background: var(--accent); width: auto; font-size: 10px; padding: 5px; float: left; }

        details { background: #f8f9fa; border: 1px solid #eee; border-radius: 5px; margin-bottom: 5px; }
        summary { padding: 10px; cursor: pointer; font-size: 13px; font-weight: bold; }
        .details-content { padding: 10px; }

        /* Checkbox styling */
        .checkbox-group { display: flex; align-items: center; gap: 10px; margin-bottom: 5px; font-size: 12px; }
        .checkbox-group input { width: auto; margin: 0; }

        /* --- Preview Area --- */
        .preview-area {
            flex: 1;
            background: #525659;
            overflow-y: auto;
            padding: 30px;
            display: flex;
            justify-content: center;
        }

        #pdf-container { width: 210mm; }

        .sheet {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin-bottom: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            position: relative;
            page-break-after: always;
        }

        /* --- Styles inside PDF --- */
        .page-header { text-align: center; border-bottom: 3px solid var(--primary); padding-bottom: 15px; margin-bottom: 30px; }
        .page-header h2 { margin: 0; color: var(--primary); }

        /* Cover */
        .cover-content { display: flex; flex-direction: column; justify-content: center; align-items: center; height: 240mm; border: 4px double var(--primary); }
        .cover-title { font-size: 38px; color: var(--primary); margin-bottom: 40px; text-align: center; font-weight: 800; }
        
        /* Lists */
        .styled-list { list-style: none; padding: 0; }
        .styled-list li { margin-bottom: 15px; padding-right: 25px; position: relative; font-size: 15px; line-height: 1.6; }
        .styled-list li::before { content: 'âœ”'; position: absolute; right: 0; color: var(--secondary); font-weight: bold; }

        /* Guidelines */
        .guideline-box { background: #fdfdfd; border-right: 4px solid var(--accent); padding: 15px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* Tools Grid */
        .tools-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 30px; }
        .tool-card { 
            border: 2px solid #eee; 
            border-radius: 10px; 
            padding: 20px; 
            text-align: center; 
            display: flex; 
            flex-direction: column; 
            align-items: center;
            background: #fff;
        }
        .tool-card i { font-size: 40px; color: var(--primary); margin-bottom: 10px; }
        .tool-card span { font-size: 18px; font-weight: bold; color: #555; }

        /* Tables */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; }
        th, td { border: 1px solid #333; padding: 8px; text-align: center; font-size: 11px; }
        th { background: #eee; }

        /* End Page */
        .end-page { display: flex; justify-content: center; align-items: center; height: 250mm; }
        .end-text { font-size: 50px; color: var(--primary); font-family: 'Amiri', serif; }

    </style>
</head>
<body>

<div class="sidebar">
    <h3 style="text-align:center;">ğŸ›  Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</h3>

    <details open><summary>1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</summary>
        <div class="details-content">
            <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</label><input type="text" id="inTitle" oninput="render()">
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø¨</label><input type="text" id="inTrainer" oninput="render()">
            <label>Ø§Ù„Ø¹Ø§Ù…</label><input type="text" id="inYear" value="2026" oninput="render()">
            <label>Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</label><textarea id="inIntro" oninput="render()"></textarea>
        </div>
    </details>

    <details><summary>2. Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª (Ø¬Ø¯ÙŠØ¯)</summary>
        <div class="details-content">
            <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø¨ (ÙƒÙ„ Ù†Ù‚Ø·Ø© ÙÙŠ Ø³Ø·Ø±)</label>
            <textarea id="inTrainerGuide" style="height:80px" oninput="render()">Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ù‚Ø§Ø¹Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ù†ØµÙ Ø³Ø§Ø¹Ø©.
Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®Ø·Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.
ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²Ù†.</textarea>
            
            <label>Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ† (ÙƒÙ„ Ù†Ù‚Ø·Ø© ÙÙŠ Ø³Ø·Ø±)</label>
            <textarea id="inTraineeGuide" style="height:80px" oninput="render()">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ù„Ø¬Ù„Ø³Ø§Øª.
Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙØ¹Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©.
ÙˆØ¶Ø¹ Ø§Ù„Ø¬ÙˆØ§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØµØ§Ù…Øª.</textarea>
        </div>
    </details>

    <details><summary>3. Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</summary>
        <div class="details-content">
            <label>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹Ø§Ù…</label><textarea id="inMainGoal" oninput="render()"></textarea>
            <div id="goals-inputs"></div>
        </div>
    </details>

    <details><summary>4. Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</summary>
        <div class="details-content" id="schedule-inputs"></div>
    </details>

    <details><summary>5. Ø§Ù„Ù…Ø¹ÙŠÙ†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</summary>
        <div class="details-content">
            <label>Ø§Ø®ØªØ± Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ù„ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ø­Ù‚ÙŠØ¨Ø©:</label>
            <div class="checkbox-group"><input type="checkbox" id="tool1" checked onchange="render()"> Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„ÙˆØ±Ù‚ÙŠØ© (Flip Chart)</div>
            <div class="checkbox-group"><input type="checkbox" id="tool2" checked onchange="render()"> Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„Ø°ÙƒÙŠØ©</div>
            <div class="checkbox-group"><input type="checkbox" id="tool3" checked onchange="render()"> Ø£Ù‚Ù„Ø§Ù… Ù…Ù„ÙˆÙ†Ø©</div>
            <div class="checkbox-group"><input type="checkbox" id="tool4" checked onchange="render()"> Ù…Ù„ØµÙ‚Ø§Øª Ù…Ù„ÙˆÙ†Ø© (Sticky Notes)</div>
            <div class="checkbox-group"><input type="checkbox" id="tool5" checked onchange="render()"> Ø¬Ù‡Ø§Ø² Ù„Ø§Ø¨ØªÙˆØ¨</div>
            <div class="checkbox-group"><input type="checkbox" id="tool6" checked onchange="render()"> Ø¬Ù‡Ø§Ø² Ø¹Ø±Ø¶ (Data Show)</div>
            <div class="checkbox-group"><input type="checkbox" id="tool7" onchange="render()"> Ù†Ø¸Ø§Ù… ØµÙˆØªÙŠ (Ø³Ù…Ø§Ø¹Ø§Øª)</div>
        </div>
    </details>

    <div id="units-control" style="margin-top:10px;"></div>
    <button class="btn btn-green" onclick="addUnit()">+ ÙˆØ­Ø¯Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ©</button>

    <details style="margin-top:10px;"><summary>Ø§Ù„Ø®Ø§ØªÙ…Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹</summary>
        <div class="details-content">
            <textarea id="inConclusion" placeholder="Ø§Ù„Ø®Ø§ØªÙ…Ø©" oninput="render()"></textarea>
            <textarea id="inRefs" placeholder="Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹" oninput="render()"></textarea>
        </div>
    </details>

    <button class="btn btn-blue" onclick="printPDF()">ğŸ“¥ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø­Ù‚ÙŠØ¨Ø© PDF</button>
</div>

<div class="preview-area">
    <div id="pdf-container">
        
        <div class="sheet">
            <div class="cover-content">
                <i class="fas fa-shapes" style="font-size:80px; color:var(--secondary); margin-bottom:20px;"></i>
                <h1 class="cover-title" id="outTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h1>
                <p style="font-size:20px;">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¯Ø±Ø¨: <span id="outTrainer">---</span></p>
                <p style="font-size:18px; color:#777;">Ø¹Ø§Ù…: <span id="outYear">---</span></p>
            </div>
        </div>

        <div class="sheet">
            <div class="page-header"><h2>Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2></div>
            <div id="outIntro" style="text-align:justify; line-height:1.8; font-size:16px;">...</div>
        </div>

        <div class="sheet">
            <div class="page-header"><h2>ğŸ‘¨â€ğŸ« Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù„Ù„Ù…Ø¯Ø±Ø¨</h2></div>
            <p style="color:#666; margin-bottom:20px;">Ù„Ø¶Ù…Ø§Ù† Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø¨ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©ØŒ ÙŠØ±Ø¬Ù‰ Ø§ØªØ¨Ø§Ø¹ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
            <ul class="styled-list" id="outTrainerGuide"></ul>
        </div>

        <div class="sheet">
            <div class="page-header"><h2>ğŸ‘¥ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù„Ù„Ù…ØªØ¯Ø±Ø¨ÙŠÙ†</h2></div>
            <p style="color:#666; margin-bottom:20px;">Ø¹Ø²ÙŠØ²ÙŠ Ø§Ù„Ù…ØªØ¯Ø±Ø¨ØŒ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‚ØµÙ‰ Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ØŒ Ù†Ø£Ù…Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ø¢ØªÙŠ:</p>
            <ul class="styled-list" id="outTraineeGuide"></ul>
        </div>

        <div class="sheet">
            <div class="page-header"><h2>Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</h2></div>
            <div class="guideline-box">
                <h3 style="color:var(--primary)">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹Ø§Ù…:</h3>
                <p id="outMainGoal">...</p>
            </div>
            <h3 style="margin-top:30px;">Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©:</h3>
            <ul class="styled-list" id="outSubGoals"></ul>
        </div>

        <div id="schedule-sheets"></div>

        <div class="sheet">
            <div class="page-header"><h2>ğŸ›  Ø§Ù„Ù…Ø¹ÙŠÙ†Ø§Øª ÙˆØ§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</h2></div>
            <p style="text-align:center; margin-bottom:30px;">ØªØªØ·Ù„Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ù‚ÙŠØ¨Ø© ØªÙˆÙØ± Ø§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ù‚Ø§Ø¹Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨:</p>
            <div class="tools-grid" id="outTools">
                </div>
        </div>

        <div id="units-sheets"></div>

        <div class="sheet">
            <div class="page-header"><h2>Ø§Ù„Ø®Ø§ØªÙ…Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹</h2></div>
            <h3>Ø§Ù„Ø®Ø§ØªÙ…Ø©:</h3>
            <div id="outConclusion">...</div>
            <hr style="margin:40px 0;">
            <h3>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ ÙˆØ§Ù„Ù…ØµØ§Ø¯Ø±:</h3>
            <div id="outRefs">...</div>
        </div>

        <div class="sheet">
            <div class="end-page">
                <div class="end-text">ØªÙ… Ø¨Ø­Ù…Ø¯ Ø§Ù„Ù„Ù‡</div>
            </div>
        </div>

    </div>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const daysCount = 5;
    let unitCount = 0;
    
    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª (Icon mapping)
    const toolsData = {
        'tool1': { icon: 'fa-scroll', text: 'Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„ÙˆØ±Ù‚ÙŠØ© (Flip Chart)' },
        'tool2': { icon: 'fa-chalkboard-user', text: 'Ø§Ù„Ø³Ø¨ÙˆØ±Ø© Ø§Ù„Ø°ÙƒÙŠØ©' },
        'tool3': { icon: 'fa-pen-nib', text: 'Ø£Ù‚Ù„Ø§Ù… Ù…Ù„ÙˆÙ†Ø©' },
        'tool4': { icon: 'fa-note-sticky', text: 'Ù…Ù„ØµÙ‚Ø§Øª (Sticky Notes)' },
        'tool5': { icon: 'fa-laptop', text: 'Ø¬Ù‡Ø§Ø² Ù„Ø§Ø¨ØªÙˆØ¨' },
        'tool6': { icon: 'fa-video', text: 'Ø¬Ù‡Ø§Ø² Ø¹Ø±Ø¶ (Data Show)' },
        'tool7': { icon: 'fa-volume-high', text: 'Ù†Ø¸Ø§Ù… ØµÙˆØªÙŠ' }
    };

    window.onload = function() {
        createGoalInputs();
        createScheduleInputs();
        addUnit(); 
        render(); 
    };

    function createGoalInputs() {
        let html = '';
        for(let i=1; i<=7; i++) html += `<input type="text" id="g${i}" placeholder="Ù‡Ø¯Ù ${i}" oninput="render()" style="margin-bottom:5px">`;
        document.getElementById('goals-inputs').innerHTML = html;
    }

    function createScheduleInputs() {
        let container = document.getElementById('schedule-inputs');
        for(let d=1; d<=daysCount; d++) {
            let details = document.createElement('details');
            details.innerHTML = `<summary>Ø§Ù„ÙŠÙˆÙ… ${d}</summary><div class="details-content" id="day-inputs-${d}"></div>`;
            container.appendChild(details);
            let content = details.querySelector('.details-content');
            for(let s=1; s<=2; s++) {
                content.innerHTML += `<div style="background:#eee; padding:5px; margin-top:5px;">Ø§Ù„Ø¬Ù„Ø³Ø© ${s}</div>`;
                for(let r=1; r<=5; r++) {
                    content.innerHTML += `<div style="display:grid; grid-template-columns: 2fr 1fr 1fr 0.5fr; gap:2px; margin-top:2px;">
                        <input class="d${d}s${s}r${row}_topic" placeholder="Ù…Ø­ÙˆØ±" oninput="render()">
                        <input class="d${d}s${s}r${row}_method" placeholder="Ø£Ø³Ù„ÙˆØ¨" oninput="render()">
                        <input class="d${d}s${s}r${row}_tool" placeholder="Ø£Ø¯ÙˆØ§Øª" oninput="render()">
                        <input class="d${d}s${s}r${row}_time" placeholder="Ø²Ù…Ù†" oninput="render()">
                    </div>`.replace(/row/g, r);
                }
            }
        }
    }

    function addUnit() {
        unitCount++;
        let div = document.createElement('div');
        div.className = 'unit-input-group';
        div.innerHTML = `
            <div style="background:#7f8c8d; color:white; padding:5px; margin-top:10px;">ÙˆØ­Ø¯Ø© ${unitCount}</div>
            <input type="text" class="u-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆØ­Ø¯Ø©" oninput="render()">
            <textarea class="u-content" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©" oninput="render()"></textarea>
            <textarea class="u-act" placeholder="Ø§Ù„Ù†Ø´Ø§Ø·" oninput="render()"></textarea>
            <textarea class="u-eval" placeholder="Ø§Ù„ØªÙ‚ÙŠÙŠÙ…" oninput="render()"></textarea>
            <textarea class="u-extra" placeholder="Ø¥Ø«Ø±Ø§Ø¡" oninput="render()"></textarea>
        `;
        document.getElementById('units-control').appendChild(div);
        render();
    }

    function render() {
        // Basic Info
        document.getElementById('outTitle').innerText = document.getElementById('inTitle').value || 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬';
        document.getElementById('outTrainer').innerText = document.getElementById('inTrainer').value || '---';
        document.getElementById('outYear').innerText = document.getElementById('inYear').value || '---';
        document.getElementById('outIntro').innerHTML = document.getElementById('inIntro').value.replace(/\n/g, '<br>') || '...';
        
        // Guidelines (Split lines to list items)
        document.getElementById('outTrainerGuide').innerHTML = splitToList(document.getElementById('inTrainerGuide').value);
        document.getElementById('outTraineeGuide').innerHTML = splitToList(document.getElementById('inTraineeGuide').value);

        // Goals
        document.getElementById('outMainGoal').innerText = document.getElementById('inMainGoal').value || '...';
        let goalsHtml = '';
        for(let i=1; i<=7; i++) {
            let val = document.getElementById(`g${i}`).value;
            if(val) goalsHtml += `<li>${val}</li>`;
        }
        document.getElementById('outSubGoals').innerHTML = goalsHtml;

        // Schedule
        let scheduleHtml = '';
        for(let d=1; d<=daysCount; d++) {
            scheduleHtml += `<div class="sheet"><div class="page-header"><h2>Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ: ${d}</h2></div>${buildDayTable(d)}</div>`;
        }
        document.getElementById('schedule-sheets').innerHTML = scheduleHtml;

        // Tools (Icons)
        let toolsHtml = '';
        for (let i = 1; i <= 7; i++) {
            if(document.getElementById(`tool${i}`).checked) {
                toolsHtml += `
                <div class="tool-card">
                    <i class="fa-solid ${toolsData[`tool${i}`].icon}"></i>
                    <span>${toolsData[`tool${i}`].text}</span>
                </div>`;
            }
        }
        document.getElementById('outTools').innerHTML = toolsHtml;

        // Units
        let unitsHtml = '';
        document.querySelectorAll('.unit-input-group').forEach((grp, index) => {
            let uId = index + 1;
            let title = grp.querySelector('.u-title').value || `Ø§Ù„ÙˆØ­Ø¯Ø© ${uId}`;
            let content = grp.querySelector('.u-content').value.replace(/\n/g, '<br>');
            let act = grp.querySelector('.u-act').value.replace(/\n/g, '<br>');
            let eval = grp.querySelector('.u-eval').value.replace(/\n/g, '<br>');
            let extra = grp.querySelector('.u-extra').value.replace(/\n/g, '<br>');

            unitsHtml += `
            <div class="sheet">
                <div class="page-header"><h2>${title}</h2></div>
                <h4 style="color:var(--secondary)">Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©:</h4><div style="text-align:justify; margin-bottom:20px;">${content}</div>
                <h4 style="color:var(--accent)">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠ:</h4><div class="guideline-box">${act}</div>
                <h4 style="color:#8e44ad">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:</h4><div>${eval}</div>
                <hr><h4 style="color:#27ae60">Ø¥Ø«Ø±Ø§Ø¡:</h4><div>${extra}</div>
            </div>`;
        });
        document.getElementById('units-sheets').innerHTML = unitsHtml;

        // Conclusion & Refs
        document.getElementById('outConclusion').innerHTML = document.getElementById('inConclusion').value.replace(/\n/g, '<br>');
        document.getElementById('outRefs').innerHTML = document.getElementById('inRefs').value.replace(/\n/g, '<br>');
    }

    function splitToList(text) {
        if(!text) return '';
        return text.split('\n').map(line => line.trim()).filter(line => line).map(line => `<li>${line}</li>`).join('');
    }

    function buildDayTable(d) {
        let html = `<table><thead><tr><th width="40%">Ø§Ù„Ù…Ø­ÙˆØ±</th><th>Ø§Ù„Ø£Ø³Ù„ÙˆØ¨</th><th>Ø§Ù„Ø£Ø¯ÙˆØ§Øª</th><th width="10%">Ø§Ù„Ø²Ù…Ù†</th></tr></thead><tbody>`;
        html += `<tr><td colspan="4" style="background:#ddd; font-weight:bold;">Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</td></tr>`;
        for(let r=1; r<=5; r++) html += getRow(d, 1, r);
        html += `<tr><td colspan="4" style="background:#ffeaa7; font-weight:bold;">â˜• Ø§Ø³ØªØ±Ø§Ø­Ø© 20 Ø¯Ù‚ÙŠÙ‚Ø©</td></tr>`;
        html += `<tr><td colspan="4" style="background:#ddd; font-weight:bold;">Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</td></tr>`;
        for(let r=1; r<=5; r++) html += getRow(d, 2, r);
        html += `</tbody></table>`;
        return html;
    }

    function getRow(d, s, r) {
        let topic = document.querySelector(`.d${d}s${s}r${r}_topic`)?.value || '';
        let method = document.querySelector(`.d${d}s${s}r${r}_method`)?.value || '';
        let tool = document.querySelector(`.d${d}s${s}r${r}_tool`)?.value || '';
        let time = document.querySelector(`.d${d}s${s}r${r}_time`)?.value || '';
        return `<tr><td>${topic}</td><td>${method}</td><td>${tool}</td><td>${time}</td></tr>`;
    }

    function printPDF() {
        const element = document.getElementById('pdf-container');
        const opt = { margin: 0, filename: 'Ø­Ù‚ÙŠØ¨Ø©_ØªØ¯Ø±ÙŠØ¨ÙŠØ©_Ù…ØªÙƒØ§Ù…Ù„Ø©.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, useCORS: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
        html2pdf().from(element).set(opt).save();
    }
</script>

</body>
</html>
